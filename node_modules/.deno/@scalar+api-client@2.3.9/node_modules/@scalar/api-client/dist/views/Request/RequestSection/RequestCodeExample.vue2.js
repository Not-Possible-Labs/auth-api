import { defineComponent as b, computed as i, openBlock as w, createElementBlock as x, createVNode as n, withCtx as c, createTextVNode as S, createElementVNode as m, unref as r, toDisplayString as C } from "vue";
import { ScalarCombobox as k, ScalarButton as $, ScalarIcon as g } from "@scalar/components";
import { snippetz as K } from "@scalar/snippetz";
import V from "../../../components/DataTable/DataTable.vue.js";
import H from "../../../components/DataTable/DataTableRow.vue.js";
import U from "../../../components/ViewLayout/ViewLayoutCollapse.vue.js";
import { filterSecurityRequirements as _ } from "./helpers/filter-security-requirements.js";
import j from "../../Components/CodeSnippet/CodeSnippet.vue.js";
import { useWorkspace as B } from "../../../store/store.js";
const D = { class: "w-full" }, E = { class: "-mx-1 flex flex-1" }, N = { class: "bg-b-1 flex items-center justify-center overflow-hidden border-t" }, P = /* @__PURE__ */ b({
  __name: "RequestCodeExample",
  props: {
    collection: {},
    example: {},
    operation: {},
    server: {},
    workspace: {}
  },
  setup(o) {
    const { securitySchemes: u, workspaceMutators: p } = B(), f = i(
      () => _(
        o.operation.security || o.collection.security || [],
        o.operation.selectedSecuritySchemeUids || o.collection.selectedSecuritySchemeUids,
        u
      )
    ), a = i(() => {
      const e = {};
      return {
        options: K().clients().map((t) => ({
          label: t.title,
          options: t.clients.map((s) => (e[`${t.key},${s.client}`] = s.title, {
            id: `${t.key},${s.client}`,
            label: s.title
          }))
        })),
        dict: e
      };
    }), d = i(() => {
      var t;
      const e = o.workspace.selectedHttpClient;
      if (!e)
        return ((t = a.value.options[0]) == null ? void 0 : t.options[0]) ?? {
          id: "js,fetch",
          label: "Fetch"
        };
      const l = `${e.targetKey},${e.clientKey}`;
      return {
        id: l,
        label: a.value.dict[l] ?? "Unknown"
      };
    }), y = i(
      () => {
        var e;
        return ((e = o.workspace.selectedHttpClient) == null ? void 0 : e.targetKey) ?? "js";
      }
    ), v = i(
      () => {
        var e;
        return ((e = o.workspace.selectedHttpClient) == null ? void 0 : e.clientKey) ?? "fetch";
      }
    ), h = ({ id: e }) => {
      const [l, t] = e.split(",");
      !l || !t || p.edit(o.workspace.uid, "selectedHttpClient", {
        targetKey: l,
        clientKey: t
      });
    };
    return (e, l) => (w(), x("div", D, [
      n(U, {
        class: "group/preview w-full border-b-0",
        defaultOpen: !1
      }, {
        title: c(() => l[0] || (l[0] = [
          S("Code Snippet")
        ])),
        actions: c(() => [
          m("div", E, [
            n(r(k), {
              modelValue: d.value,
              options: a.value.options,
              placement: "bottom-end",
              "onUpdate:modelValue": h
            }, {
              default: c(() => [
                n(r($), {
                  class: "text-c-1 hover:bg-b-3 py-0.75 flex h-full w-fit gap-1.5 px-1.5 font-normal",
                  fullWidth: "",
                  variant: "ghost"
                }, {
                  default: c(() => {
                    var t;
                    return [
                      m("span", null, C((t = d.value) == null ? void 0 : t.label), 1),
                      n(r(g), {
                        icon: "ChevronDown",
                        size: "md"
                      })
                    ];
                  }),
                  _: 1
                })
              ]),
              _: 1
            }, 8, ["modelValue", "options"])
          ])
        ]),
        default: c(() => [
          n(V, { columns: [""] }, {
            default: c(() => [
              n(H, null, {
                default: c(() => [
                  m("div", N, [
                    n(r(j), {
                      class: "px-3 py-1.5",
                      client: v.value,
                      example: e.example,
                      operation: e.operation,
                      securitySchemes: f.value,
                      server: e.server,
                      target: y.value
                    }, null, 8, ["client", "example", "operation", "securitySchemes", "server", "target"])
                  ])
                ]),
                _: 1
              })
            ]),
            _: 1
          })
        ]),
        _: 1
      })
    ]));
  }
});
export {
  P as default
};
