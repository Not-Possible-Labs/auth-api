import { defineComponent as P, computed as k, unref as e, openBlock as a, createElementBlock as y, normalizeClass as S, createElementVNode as W, createVNode as n, isRef as H, withCtx as b, createBlock as u, createCommentVNode as L } from "vue";
import x from "../../components/EmptyState.vue.js";
import N from "../../components/ViewLayout/ViewLayout.vue.js";
import g from "../../components/ViewLayout/ViewLayoutContent.vue.js";
import { useSidebar as B } from "../../hooks/useSidebar.js";
import { importCurlCommand as I } from "../../libs/importers/curl.js";
import { useActiveEntities as z } from "../../store/active-entities.js";
import A from "./RequestSection/RequestSection.vue.js";
import D from "./RequestSubpageHeader.vue.js";
import M from "./ResponseSection/ResponseSection.vue.js";
import { useWorkspace as h } from "../../store/store.js";
import { useLayout as O } from "../../hooks/useLayout.js";
const T = { class: "flex h-full" }, $ = {
  key: 0,
  class: "flex h-full flex-1 flex-col"
}, ae = /* @__PURE__ */ P({
  __name: "Request",
  props: {
    invalidParams: {}
  },
  emits: ["newTab"],
  setup(j) {
    const { events: C } = h(), { isSidebarOpen: l } = B(), V = h(), { layout: d } = O(), {
      activeCollection: r,
      activeExample: m,
      activeRequest: s,
      activeWorkspace: c,
      activeServer: p,
      activeEnvVariables: v,
      activeEnvironment: f,
      activeWorkspaceRequests: _
    } = z(), { modalState: R, requestHistory: q } = V, w = k(
      () => q.findLast((o) => {
        var t;
        return o.request.uid === ((t = m.value) == null ? void 0 : t.uid);
      })
    ), E = k(
      () => {
        var o, t;
        return (d === "modal" ? (o = r.value) == null ? void 0 : o.selectedSecuritySchemeUids : (t = s.value) == null ? void 0 : t.selectedSecuritySchemeUids) ?? [];
      }
    );
    function U(o) {
      var t;
      C.commandPalette.emit({
        commandName: "Import from cURL",
        metaData: {
          parsedCurl: I(o),
          collectionUid: (t = r.value) == null ? void 0 : t.uid
        }
      });
    }
    return (o, t) => e(r) && e(c) ? (a(), y("div", {
      key: 0,
      class: S(["bg-b-1 relative z-0 flex h-full flex-1 flex-col overflow-hidden pt-0", {
        "!mb-0 !mr-0 !border-0": e(d) === "modal"
      }])
    }, [
      W("div", T, [
        e(s) ? (a(), y("div", $, [
          n(D, {
            modelValue: e(l),
            "onUpdate:modelValue": t[0] || (t[0] = (i) => H(l) ? l.value = i : null),
            collection: e(r),
            envVariables: e(v),
            environment: e(f),
            operation: e(s),
            server: e(p),
            workspace: e(c),
            onHideModal: t[1] || (t[1] = () => e(R).hide()),
            onImportCurl: U
          }, null, 8, ["modelValue", "collection", "envVariables", "environment", "operation", "server", "workspace"]),
          n(N, null, {
            default: b(() => [
              e(m) ? (a(), u(g, {
                key: 0,
                class: S(["flex-1", [e(l) ? "sidebar-active-hide-layout" : ""]])
              }, {
                default: b(() => {
                  var i;
                  return [
                    n(A, {
                      collection: e(r),
                      envVariables: e(v),
                      environment: e(f),
                      example: e(m),
                      invalidParams: o.invalidParams,
                      operation: e(s),
                      selectedSecuritySchemeUids: E.value,
                      server: e(p),
                      workspace: e(c)
                    }, null, 8, ["collection", "envVariables", "environment", "example", "invalidParams", "operation", "selectedSecuritySchemeUids", "server", "workspace"]),
                    n(M, {
                      numWorkspaceRequests: e(_).length,
                      response: (i = w.value) == null ? void 0 : i.response
                    }, null, 8, ["numWorkspaceRequests", "response"])
                  ];
                }),
                _: 1
              }, 8, ["class"])) : L("", !0)
            ]),
            _: 1
          })
        ])) : (a(), u(x, { key: 1 }))
      ])
    ], 2)) : (a(), u(x, { key: 1 }));
  }
});
export {
  ae as default
};
