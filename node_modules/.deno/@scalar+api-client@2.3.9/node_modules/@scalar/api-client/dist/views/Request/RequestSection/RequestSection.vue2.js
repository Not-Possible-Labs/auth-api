import { defineComponent as E, computed as p, useId as O, ref as H, watch as N, openBlock as m, createBlock as b, withCtx as v, createElementVNode as d, unref as t, createElementBlock as c, createCommentVNode as w, toDisplayString as I, createVNode as n, withDirectives as i, vShow as s } from "vue";
import { ScalarErrorBoundary as K } from "@scalar/components";
import { canMethodHaveBody as f, isDefined as U, REGEX as V } from "@scalar/oas-utils/helpers";
import D from "../../../components/SectionFilter.vue.js";
import Q from "../../../components/ViewLayout/ViewLayoutSection.vue.js";
import { matchesDomain as $ } from "../../../libs/send-request/set-request-cookies.js";
import L from "./RequestBody.vue.js";
import y from "./RequestParams.vue.js";
import j from "./RequestPathParams.vue.js";
import F from "./RequestAuth/RequestAuth.vue.js";
import M from "./RequestCodeExample.vue.js";
import { useWorkspace as T } from "../../../store/store.js";
import { useLayout as W } from "../../../hooks/useLayout.js";
const z = { class: "group pointer-events-none flex flex-1 items-center gap-1 lg:pr-24" }, G = {
  key: 0,
  class: "pointer-events-auto absolute left-0 top-0 h-full w-full cursor-text opacity-0",
  for: "requestname"
}, X = ["placeholder", "value"], J = {
  key: 2,
  class: "text-c-1 flex h-8 items-center"
}, Y = ["id", "role"], ue = /* @__PURE__ */ E({
  __name: "RequestSection",
  props: {
    collection: {},
    environment: {},
    envVariables: {},
    example: {},
    invalidParams: {},
    operation: {},
    selectedSecuritySchemeUids: {},
    server: {},
    workspace: {}
  },
  setup(l) {
    const A = [
      "Auth",
      "Variables",
      "Cookies",
      "Headers",
      "Query",
      "Body"
    ], { requestMutators: q, cookies: P, securitySchemes: S } = T(), { layout: u } = W(), h = p(() => {
      const e = /* @__PURE__ */ new Set(["All", ...A]);
      return l.example.parameters.path.length || e.delete("Variables"), f(l.operation.method ?? "get") || e.delete("Body"), k.value && e.delete("Auth"), [...e];
    }), r = p(
      () => Object.fromEntries(
        h.value.map((e) => [e, O()])
      )
    ), k = p(
      () => {
        var e;
        return u === "modal" && ((e = l.operation.security) == null ? void 0 : e.length) === 0;
      }
    ), a = H("All");
    N(
      () => l.operation,
      (e) => {
        a.value === "Body" && e && !f(e.method) && (a.value = "All");
      }
    );
    const g = (e) => {
      const o = e.target;
      q.edit(l.operation.uid, "summary", o.value);
    }, B = p(
      () => (l.workspace.cookies ?? []).map((e) => P[e]).filter(U).filter((e) => e.name).filter(
        (e) => {
          var o;
          return $(((o = l.server) == null ? void 0 : o.url) || l.operation.path, e.domain);
        }
      ).map((e) => ({
        key: e.name,
        value: e.value,
        route: {
          name: "cookies",
          params: {
            cookies: e.uid
          }
        },
        enabled: !0
      }))
    ), C = () => l.operation.summary ? l.operation.summary : l.operation.path.replace(V.PROTOCOL, "") ? l.operation.path.replace(V.PROTOCOL, "") : "Request Name";
    return (e, o) => (m(), b(Q, {
      "aria-label": `Request: ${e.operation.summary}`
    }, {
      title: v(() => [
        d("div", z, [
          t(u) !== "modal" ? (m(), c("label", G)) : w("", !0),
          t(u) !== "modal" ? (m(), c("input", {
            key: 1,
            id: "requestname",
            class: "text-c-1 group-hover-input pl-1.25 md:-ml-1.25 pointer-events-auto relative z-10 -ml-0.5 h-8 w-full rounded has-[:focus-visible]:outline",
            placeholder: C(),
            value: e.operation.summary,
            onInput: g
          }, null, 40, X)) : (m(), c("span", J, I(e.operation.summary), 1))
        ]),
        n(D, {
          modelValue: a.value,
          "onUpdate:modelValue": o[0] || (o[0] = (R) => a.value = R),
          filterIds: r.value,
          filters: h.value
        }, null, 8, ["modelValue", "filterIds", "filters"])
      ]),
      default: v(() => [
        d("div", {
          id: r.value.All,
          class: "request-section-content custom-scroll relative flex flex-1 flex-col divide-y",
          role: a.value === "All" ? "tabpanel" : "none"
        }, [
          e.collection && e.workspace && (t(u) !== "modal" || Object.keys(t(S) ?? {}).length) ? i((m(), b(F, {
            key: 0,
            class: "request-section-content-auth",
            id: r.value.Auth,
            collection: e.collection,
            envVariables: e.envVariables,
            environment: e.environment,
            layout: "client",
            operation: e.operation,
            role: a.value === "All" ? "none" : "tabpanel",
            selectedSecuritySchemeUids: e.selectedSecuritySchemeUids,
            server: e.server,
            title: "Authentication",
            workspace: e.workspace
          }, null, 8, ["id", "collection", "envVariables", "environment", "operation", "role", "selectedSecuritySchemeUids", "server", "workspace"])), [
            [
              s,
              !k.value && (a.value === "All" || a.value === "Auth")
            ]
          ]) : w("", !0),
          i(n(j, {
            class: "request-section-content-path-params",
            id: r.value.Variables,
            envVariables: e.envVariables,
            environment: e.environment,
            example: e.example,
            invalidParams: e.invalidParams,
            operation: e.operation,
            paramKey: "path",
            role: a.value === "All" ? "none" : "tabpanel",
            title: "Variables",
            workspace: e.workspace
          }, null, 8, ["id", "envVariables", "environment", "example", "invalidParams", "operation", "role", "workspace"]), [
            [
              s,
              (a.value === "All" || a.value === "Variables") && e.example.parameters.path.length
            ]
          ]),
          i(n(y, {
            class: "request-section-content-cookies",
            id: r.value.Cookies,
            envVariables: e.envVariables,
            environment: e.environment,
            example: e.example,
            invalidParams: e.invalidParams,
            operation: e.operation,
            paramKey: "cookies",
            readOnlyEntries: B.value,
            role: a.value === "All" ? "none" : "tabpanel",
            title: "Cookies",
            workspace: e.workspace,
            workspaceParamKey: "cookies"
          }, null, 8, ["id", "envVariables", "environment", "example", "invalidParams", "operation", "readOnlyEntries", "role", "workspace"]), [
            [s, a.value === "All" || a.value === "Cookies"]
          ]),
          i(n(y, {
            class: "request-section-content-headers",
            id: r.value.Headers,
            envVariables: e.envVariables,
            environment: e.environment,
            example: e.example,
            invalidParams: e.invalidParams,
            operation: e.operation,
            paramKey: "headers",
            role: a.value === "All" ? "none" : "tabpanel",
            title: "Headers",
            workspace: e.workspace
          }, null, 8, ["id", "envVariables", "environment", "example", "invalidParams", "operation", "role", "workspace"]), [
            [s, a.value === "All" || a.value === "Headers"]
          ]),
          i(n(y, {
            class: "request-section-content-query",
            id: r.value.Query,
            envVariables: e.envVariables,
            environment: e.environment,
            example: e.example,
            invalidParams: e.invalidParams,
            operation: e.operation,
            paramKey: "query",
            role: a.value === "All" ? "none" : "tabpanel",
            title: "Query Parameters",
            workspace: e.workspace
          }, null, 8, ["id", "envVariables", "environment", "example", "invalidParams", "operation", "role", "workspace"]), [
            [s, a.value === "All" || a.value === "Query"]
          ]),
          i(n(L, {
            class: "request-section-content-body",
            id: r.value.Body,
            envVariables: e.envVariables,
            environment: e.environment,
            example: e.example,
            operation: e.operation,
            role: a.value === "All" ? "none" : "tabpanel",
            title: "Body",
            workspace: e.workspace
          }, null, 8, ["id", "envVariables", "environment", "example", "operation", "role", "workspace"]), [
            [
              s,
              e.operation.method && (a.value === "All" || a.value === "Body") && t(f)(e.operation.method)
            ]
          ]),
          o[1] || (o[1] = d("div", { class: "-my-0.25 flex flex-grow" }, null, -1)),
          n(t(K), null, {
            default: v(() => [
              n(M, {
                class: "request-section-content-code-example",
                collection: e.collection,
                example: e.example,
                operation: e.operation,
                server: e.server,
                workspace: e.workspace
              }, null, 8, ["collection", "example", "operation", "server", "workspace"])
            ]),
            _: 1
          })
        ], 8, Y)
      ]),
      _: 1
    }, 8, ["aria-label"]));
  }
});
export {
  ue as default
};
